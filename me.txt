                                        Lập trình WordPress

Cài đặt Wordpress và công cụ lập trình
    Create new Database with name: wordpress
    https://wordpress.org/download/
    Download wordpress-5.5.1.zip and unzip, then copy to C:\xampp\htdocs\wordpress
    C:\Windows\System32\drivers\etc\hosts
        127.0.0.1       wordpress.xyz
    C:\xampp\apache\conf\extra\httpd-vhosts.conf
        <VirtualHost *:80>
            ServerAdmin wordpress.xyz
            DocumentRoot "C:/xampp/htdocs/wordpress"
            ServerName wordpress.xyz
            ErrorLog "logs/wordpress.xyz-error.log"
            CustomLog "logs/wordpress.xyz-access.log" common
        </VirtualHost>
    Browser access http://wordpress.xyz/wp-admin/setup-config.php
    Language: English 
    ↓
    Database name: wordpress
    Database username: root
    Database password:
    Database host: localhost
    Table prefix: wp_
    ↓
    Information needed
    Site Title: Lap trinh WordPress
    Username: admin
    Password: 123456
    Confirm use of weak password
    Your Email: vudinhquangk53@gmail.com
    Search engine visibility
    -> Install 
    ↓
    Login with Username: admin and Password: 123456
    Will be entry http://wordpress.xyz/wp-admin/
    Thay đổi giao diện cho Visit Site
        Appearance -> Themes -> Add New -> Popular 
        Twenty Ten -> Install -> Active
    Lap trinh WordPress -> Visit Site -> Will be entry http://wordpress.xyz/ and see that Twenty Ten will be display 
Cấu trúc và cấu hình nâng cao của Wordpress
    Wp-config 01
        Cấu trúc thư mục và các tập tin
        Có 3 thư mục chính: 
            /wp-admin
            /wp-content
            /wp-includes
        Có 2 tập tin trong thư mục gốc giúp chúng ta thiết lập các giá trị cấu hình cho WP đó là tập tin: 
            wp-config.php
            .htaccess
        Thay đổi thư mục chứa tập tin wp-config.php
            C:\xampp\htdocs\wordpress\wp-config.php
            C:\xampp\htdocs\wp-config.php
            Khi hệ thống wordpress không tìm thất tập tin wp-config.php nằm trong cùng thư mục với nó thì hệ thống sẽ tìm 
                ra thư mục ngoài 1 cấp -> điều này giúp bảo mật đường dẫn của wp-config.php
    Wp-config 02
        Thiết lập tiền tố cho các bảng trong database WP
            $table_prefix  = 'wp_';
        Thay đổi URL chạy chính của WP
            define( 'WP_SITEURL', 'http://wordpress.xyz' );
            define( 'WP_HOME', 'http://wordpress.xyz' );
            http://wordpress.xyz/wp-admin/options-general.php(Admin)
                -> Settings
            WordPress Address (URL): Đường dẫn đến thư mục
            Site Address (URL): Đường dẫn khi truy cập trên Browser
            ↓
            Sẽ bị disable và người dùng sẽ không thể thay đổi giá trị được 
    Wp-config 03
        Thay đổi đường dẫn đến thư mục chứa Plugin
        define( 'WP_PLUGIN_DIR', dir(__FILE__) . '/wp-content/plugins');
        define( 'WP_PLUGIN_URL', 'http://wordpress.xyz/wp-content/plugins');
        Thay đổi giá trị của WP_POST_REVISIONS
            REVISIONS lưu lại các bài viết trước đó mà mình đã chỉnh sửa, có thể back về các 
                bài viết trước đó
            SELECT * FROM wordpress.wp_posts;
                post_content    post_title      post_status
                    ~           Hello world!    publish
                    ~           Hello world!    inherit
                publish là thể hiện giá trị đang hiển thị hiện tại, inherit là đang nằm ở REVISIONS để
                    mình có thể quay ngược lại
            define( 'WP_POST_REVISIONS', false ); -> Tắt chế độ lưu lại các Version trước đó của bài viết
            define( 'WP_POST_REVISIONS', 3 ); -> Tối đa lưu lại 3 lần
    Wp-config 04
        Thay đổi giá trị thời gian cho AUTOSAVE_INTERVAL
            define( 'AUTOSAVE_INTERVAL', 150 ); Thời gian lưu 1 bài viết khi thêm mới or Edit, mặc định là 60s
        Hiển thị các câu truy vấn trên một trang của WP
            define( 'SAVEQUERIES', true );
        Hiển thị chi tiết các câu truy vấn trên trang
            global $wpdb;
            print_r( $wpdb->queries );
        Plugin and Active to check
            function debug() {
                global $wpdb;
                echo '<pre>';
                print_r($wpdb->queries );
                echo '</pre>';
            }
            add_action('wp_footer', 'debug');
        Tăng bộ nhớ cho ứng dụng WP
            Trong quá trình vận hành 1 hệ thống bất kỳ bằng PHP thì có những lúc sẽ gặp thông báo:
                Allowed memory size of xxxxx bytes exhausted
                -> Ứng dụng đã vượt khỏi bộ nhớ cho phép của Server
            define( 'WP_MEMORY_LIMIT', '128M' );
                -> Bộ nhớ tối đa mà WordPress sẽ sử dụng là 128M 
                Giá trị được thiết lập này thì còn phụ thuộc vào cả cấu hình Server
                Đối với tập tin php.ini giá trị memory_limit=512M thì giá trị WP_MEMORY_LIMIT được 
                    thiết lập lớn hơn 512M thì cũng không có tác dụng 
        Thiết lập ngôn ngữ và định dạng quốc tế, giá trị mặc định là 'en-US'
            define ( 'WPLANG', 'en-US' );
        Thiết lập thư mục chứa các tập tin ngôn ngữ
            Default: define( 'LANGDIR', '/wp-content/languages' );
            Custom: define( 'LANGDIR', '/wp-content/my/languages' ); 
        Chia sẽ dữ liệu người dùng (Multisite) cho nhiều trang web liên kết với nhau
            define( 'CUSTOM_USER_TABLE', 'share_users' );
            define( 'CUSTOM_USER_META_TABLE', 'share_usermeta' );
            -> Hai bẳng này dùng để chia sẻ thông tin qua lại giữa các website với nhau
        Thiết lập COOKIE cho nhiều domain (Multisite) cho nhiều trang web liên kết với nhau
            define( 'COOKIE_DOMAIN', '.domain.com' );
            define( 'COOKIEPATH', '/' );
            define( 'SITECOOKIEPATH', '/' );
        Thiết lập tài khoản FTP cho website
            Khi upload 1 tập tin nào đó cho website nhưng có những tập tin rất lớn thì nó sẽ ko cho upload 
                thông qua Browser mà lúc này cần sử dụng đến cấu hình của tài khoản FTP để upload file liên
                Server
            define( 'FTP_USER', 'username' );
            define( 'FTP_PASS', 'password' );
            define( 'FTP_HOST', 'ftp.example.com:21' );
        Cấu hình thư mục FTP và SSH 
            -> Liên quan đến Hosting khi upload lên internet
            define( 'FS_METHOD', 'ftpext' );
            define( 'FTP_BASE', '/public_html/wordpress/' );
            define( 'FTP_CONTENT_DIR', '/public_html/wordpress/wp-content/' );
            define( 'FTP_PLUGIN_DIR ', '/ public_html /wordpress/wp-content/plugins/' );
            define( 'FTP_PUBKEY', '/home/username/.ssh/id_rsa.pub' );
            define( 'FTP_PRIVKEY', '/home/username/.ssh/id_rsa' );
            define( 'FTP_SSL', false );
        Thiết lập cấp phép cho thư mục
            define( 'FS_CHMOD_FILE',0644 );
            define( 'FS_CHMOD_DIR',0755 );
        Thiết lập Cache nâng cao
            define( 'WP_CACHE', true ); 
            wp-content/advanced-cache.php
        Thiết lập chế độ login
            Khi user login thì có sử dụng đường dẫn trên thanh địa chỉ là HTTPS hay không, mặc định 
                là false có nghĩa là chỉ sử dụng đường dẫn thường, có địa chỉ là HTTP 
            define( 'FORCE_SSL_LOGIN', true ); //HTTPS - HTTP
            define( 'FORCE_SSL_ADMIN', true );
        Thiết lập thời gian xóa TRASH
            Thiết lập time xóa đi các tập tin nằm trong thư mục trash
            define( 'EMPTY_TRASH_DAYS', 7 ); 
        Thiết lập chế độ Cron
            define( 'DISABLE_WP_CRON', true );
        Thiết lập giá trị không chỉnh sửa trong Admin
            Thiết lập giá trị TRUE thì link Edit trong các Plugin sẽ biến mất
            define('DISALLOW_FILE_EDIT', TRUE); 
Plugin In WordPress
    Plugin 01
        Download Plugin tại www.wordpress.org
        Wordpress API 
            http://codex.wordpress.org/WordPress_APIs
        Các nhóm API trong WP
            Plugin API
                Cung 1 tập hợp các Hook, để gắn các plugins vào và mở rộng hệ thống ra
                Có 2 loại Hook khác nhau: Action Hook và Filter Hook 
                Action Hook cho phép kích hoạt các mã Plugin, bổ xung tại các vị trí cụ thể trong quá trình
                    vận hành của WordPress
                Filter Hook Cho phép thay đổi nội dung của bài viết trước khi đưa vào Database của WordPress hoặc 
                    sau khi hệ thống lấy dữ liệu từ trong database ra, có thể thay đổi nội dung đó trước khi hiển 
                    thị trên trình duyệt  
            Widgets API
                Hỗ trợ tạo ra các Widgets nằm trên website
            Shortcode API 
                Là 1 đoạn mã ngắn sử dụng cho posts and pages.
            HTTP API
                Giúp nhận dữ liệu hoặc gửi dữ liệu từ website của mình đến website khác
            Settings API 
                Tập hợp các hàm hỗ trợ việc thiết lập các giá trị
            Options API
                Tập hợp các phương thức để lưu dữ liệu vào bảng wp_options
            Dashboard Widgets API
                Là các phương thức tạo ra các khối trong trang Dashboard của phần Admin
            Rewrite AIP
                Hỗ trợ trong quá trình thay đổi đường dẫn trên thanh địa chỉ
                Settings -> Permalink
                (Plain) http://wordpress.xyz/?p=123
            Transients API
                Tạo ra dữ liệu tạm lưu sẵn vào trong hệ thống để giảm tải quá trình xử lý dữ liệu của hệ thống WordPress
                    và làm cho website chạy nhanh hơn
            Database API
            Và một số nhóm khác
    Plugin 02
        Vị trí Plugin được load trong quá trình xử lý
            Wordpress URL 　　 → 　　 wp-config Loaded 　　→ 　 Functions Loaded
                                    　　　　　　　　　　　    　　　　↓
            Translations Loaded　←　　Pluggables Loaded　　←　　Plugins Loaded
            　　↓　
            Theme Loaded　　→　　Page Content
            Wordpress URL: Gõ địa chỉ để truy cập đến 1 website được xây dựng trên hệ thống mã nguồn mở của WordPress 
            wp-config Loaded : Load các cấu hình nằm ở trong file config, load các cấu hình nằm ở trong Database của WordPress
            Functions Loaded: Gọi các hàm xử lý chính trong lõi của WordPress
            Plugins Loaded: Lạp toàn bộ các Plugin của nó vào hệ thống, giai đoạn này là thực hiện đưa các plugins vào hệ thống 
                nhưng các plugins đó chưa hoạt động. Các Plugin này chỉ hoạt động khi hệ thống WordPress gọi đến các Action Hook 
                hay các Filter Hook
            Pluggables Loaded: Nạp các phương thức nằm trong tập tin mã nguồn của WordPress(wordpress\wp-includes\pluggable.php)
                Trong tập tin này chứa các phương thức mà mình có thể override lại
            Translations Loaded: Nạp phần ngôn ngữ cũng như định dạng của các quốc gia
            Theme Loaded: Load Theme mà mình mặc định trong hệ thống WordPress, đưa các dữ liệu đã xử xong vào trong Theme đó
            Page Content: Gửi đên trình duyệt Web cho người dùng
        Quản lý và cài đặt Plugin
            Truy cập Admin Site
            Chọn Plugins menu 
            Chọn Installed Plugins
        Plugin Directory 
            http://wordpress.org/extend/plugins/
Xây dựng Plugin căn bản
    Create plugin
        Tạo một thư mục để chứa plugin mới để dễ dàng nâng cấp và bổ xung thêm chức năng trong tương lai
        Không nên có khoảng trắng và dấu gạch dưới trong tên của thư mục
        Khi chúng ta tạo một Plugin để trách bị trùng tên chúng ta nên tạo ra một tiền tố cho Plugin mới
        Cách tạo tiền tố: <tên bạn>_<tên plugin>_
        Ví dụ: ZendVN tạo Shopping plugin vậy tiền tố sẽ là: zendvn_sp_
        Nên sử dụng tiền tố này cho các biến và hàm trong Plugin của mình
    Structure plugin
        /unique-plugin-name
            unique-plugin-name.php — Tập tin PHP chạy chính của Plugin
            uninstall.php — Tập tin uninstall plugin
            /js — Thư mục chứa các tâp tin JavaScript
            /css — Thư mục chứa các tâp tin stylesheet 
            /includes — Thư mục chứa các tâp tin PHP khác
            /images — Thư mục chứa các tâp tin hình ảnh của plugin
        Header Plugin là yêu cầu duy nhất với Plugin để nó hoạt động trong WordPress 
            <?php
            /*
            Plugin Name: ZendVN MyPlugin
            Plugin URI: http://www.zend.vn
            Description: Tim hieu ve qua trinh chuan xay dung Plugin.
            Author: ZendVN group
            Version: 1.0
            Author URI: http://www.zend.vn
            */
    Path 
        Đường dẫn tuyệt đối (Local path): 
            Là đường dẫn vật lý  đến các tập tin và thư mục trên máy của chúng ta (VD: C:\window)
            Khi nhúng các tập tin php vào trong 1 tập tin nào đó thì sẽ sử dụng đường dẫn tuyệt đối
        Đường dẫn tương đối (URL path): 
            Là đường dẫn mà người sử dụng truy cập vào máy chủ của chúng ta thông qua các trình duyệt web
            Khi nhúng các tập tin như css, js, images vào trong 1 tập tin nào đó thì sử dụng đường dẫn 
                tương đối
            plugin_dir_path( ) – đường dẫn vật lý thư mục /plugins
                plugin_dir_path( __FILE__);
            plugins_url() - đường dẫn URL thư mục /plugins 
                plugins_url("css/abc.css", __FILE__);
            includes_url() - đường dẫn URL đến thư mục /wp-includes
                includes_url("css/buttons.css");
            content_url() - đường dẫn URL đến thư mục /wp-content
            admin_url() - đường dẫn URL đến thư mục  /wp-admin 
            site_url() - Đường dẫn URL của website 
            home_url() - Đường dẫn URL home của website
    Active plugin 1
        Cú pháp:
            register_activation_hook( $file, $function ); 
            Thực hiện chạy các hành động trong quá trình kích hoạt plugin đó
        Các thông số: 
            $file - (string) (bắt buộc) - Đường dẫn đến tập tin chính của Plugin
            $function - (string) (yêu cầu) - Tên hàm, hàm này sẽ thực hiện khi plugin được kích hoạt.
        Chức năng chính của Active plugin
            Tạo các giá trị mặc định và lưu vào bảng _option trong database của WP. 
            Tạo các bảng mới trong database để chứa các dữ liệu Plugin bạn tạo ra.
        add_option( $option, $value = , $deprecated = , $autoload = 'yes' );
            Chỉ thêm giá trị vào trong bảng wp_options khi option_name chưa tồn tại trong bảng wp_options
            serialize() Chuyển mảng thành chuỗi
            unserialize() Chuyển chuỗi thành mảng
    